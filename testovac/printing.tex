<$ if large_header $>
\documentclass[a4paper,20pt,BCOR10mm,oneside,headsepline]{scrartcl}
<$ else $>
\documentclass[a4paper,twocolumn,10pt,BCOR10mm,oneside,headsepline]{scrartcl}
<$ endif $>
\usepackage[slovak]{babel}
\usepackage[utf8]{inputenc}
\usepackage{wasysym}% provides \ocircle and \Box
\usepackage{enumitem}% easy control of topsep and leftmargin for lists
\usepackage{color}% used for background color
\usepackage{forloop}% used for \Qrating and \Qlines
\usepackage{ifthen}% used for \Qitem and \QItem
\usepackage{typearea}
\areaset{17cm}{26cm}
\setlength{\topmargin}{-1cm}
\usepackage{scrpage2}
\pagestyle{scrheadings}
<$ if show_pid $>
\ihead{<<show_pid>>}
\ifoot{Podpis:}
<$ endif $>
\ohead{\pagemark}
\chead{}
\cfoot{}
\DeclareUnicodeCharacter{00A0}{~}
\newcommand{\degree}{\ensuremath{^\circ}}
\DeclareUnicodeCharacter{B0}{\degree}
\usepackage{newunicodechar}
\newunicodechar{Â´}{'}
\newcommand{\Qq}[1]{\textbf{#1}}
\newcommand{\QO}{$\Box$}
\newcounter{qr}
\newcommand{\Qrating}[1]{\QO\forloop{qr}{1}{\value{qr} < #1}{---\QO}}
\newcommand{\Qline}[1]{\rule{#1}{0.6pt}}
\newcounter{ql}
\newcommand{\Qlines}[1]{\forloop{ql}{0}{\value{ql} < #1}{\vskip0em\Qline{\linewidth}}}
\newenvironment{Qlist}{%
%  \renewcommand{\labelitemi}{\QO}
  \renewcommand{\labelitemi}{}
  \begin{itemize}[leftmargin=1.5em,topsep=-.5em]
}{%
  \end{itemize}
}
\newlength{\qt}
\newcommand{\Qtab}[2]{
  \setlength{\qt}{\linewidth}
  \addtolength{\qt}{-#1}
  \hfill\parbox[t]{\qt}{\raggedright #2}
}

\newcounter{itemnummer}
\newcommand{\Qitem}[2][]{% #1 optional, #2 notwendig
  \ifthenelse{\equal{#1}{}}{\stepcounter{itemnummer}}{}
  \ifthenelse{\equal{#1}{a}}{\stepcounter{itemnummer}}{}
  \begin{enumerate}[topsep=2pt,leftmargin=2.8em]
  \item[\textbf{\arabic{itemnummer}#1.}] #2
  \end{enumerate}
}
\definecolor{bgodd}{rgb}{0.8,0.8,0.8}
\definecolor{bgeven}{rgb}{0.9,0.9,0.9}
\newcounter{itemoddeven}
\newlength{\gb}
\newcommand{\QItem}[2][]{% #1 optional, #2 notwendig
  \setlength{\gb}{\linewidth}
  \addtolength{\gb}{-5.25pt}
  \ifthenelse{\equal{\value{itemoddeven}}{0}}{%
    \noindent\colorbox{bgeven}{\hskip-3pt\begin{minipage}{\gb}\Qitem[#1]{#2}\end{minipage}}%
    \stepcounter{itemoddeven}%
  }{%
    \noindent\colorbox{bgodd}{\hskip-3pt\begin{minipage}{\gb}\Qitem[#1]{#2}\end{minipage}}%
    \setcounter{itemoddeven}{0}%
  }
}
\begin{document}
<$ for question in questions $>\Qitem{ \Qq{<<question.body>>}
\begin{Qlist}
<$ macro wrap(s) $> \textbf{ <<s>> } <$ endmacro $>
<$ for sub in question.subs $>\item <<sub.body>> <$ if sub.answer or sub.points $> \hskip0.5cm <$ endif $> <<wrap(sub.answer) if sub.answer>> <<wrap(sub.points) if sub.points>>
<$ endfor $>
\end{Qlist}
}
<$ endfor $>
\end{document}
